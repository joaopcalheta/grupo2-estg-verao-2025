<head>
  <link href="/css/general.css" rel="stylesheet" />
  <link href="/css/company-my-announcements.css" rel="stylesheet" />
</head>

<div class="white-card full-announcement p-3">
  <div class="gap-2">
    <h3 class="mb-3 text-center"><b><%= announcement.job_name %></b></h3>
    <hr class="mb-4">
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Concelho:</span> <%= announcement.municipality%>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Freguesia:</span> <%= announcement.freg %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Morada:</span> <%= announcement.address %>
    </h5>

    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Código postal:</span> <%= announcement.postcode
      %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Regime:</span> <%= announcement.regime %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Categoria:</span> <%= announcement.category %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Tipo:</span> <%= announcement.type %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Escolaridade:</span> <%=
      announcement.education_level %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Línguas:</span>
      <%= announcement.languages && announcement.languages.length > 0 ?
      announcement.languages.join(" ; ") : "Não especificado" %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Horário:</span> <%=
      announcement.schedule.startTime %> - <%= announcement.schedule.endTime %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Salário:</span>
      <%= announcement.salary ? announcement.salary + "€" : "A combinar" %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Fim do anúncio:</span>
      <%= announcement.end_date ?
      announcement.end_date.toLocaleDateString("pt-PT") : "Indefinido" %>
    </h5>
    <h5 class="mb-1 fw-normal">
      <span class="fw-semibold">Número de vagas:</span>
      <%= announcement.numberOfPositions %>
    </h5>
    </br>  
    <img src="<%= announcement.pic %>" class="mt-2" />
    <h6 class="fw-normal mt-4"> 
      <span class="fw-semibold">Descrição:</span> <%= announcement.description %>
    </h6>

  </br>

  <% if (announcement.company_id) {  
     const c = announcement.company_id; %>

  <div class="card p-3 mt-4 mb-2">
    <!-- Botão de toggle -->
    <div class="d-flex justify-content-between align-items-center pointer" 
         onclick="toggleCompanyDetails()" style="cursor:pointer;">
      <h5 class="mb-0"><b>Dados da empresa</b></h5>
      <i id="company-arrow" class="bi bi-chevron-down"></i>
    </div>

    <!-- Conteúdo que vai ficar escondido -->
    <div id="company-details" style="display: none;" class="mt-3">
      <div class="d-flex gap-3">
        <div style="width:100px; height:100px; overflow:hidden; border-radius:8px;">
          <img src="<%= c.pic %>" 
               alt="Logo da empresa" 
               style="width:100%; height:100%; object-fit:cover;" />
        </div>
        <div class="flex-grow-1">
          <h5 class="mb-2"><b><%= c.name %></b></h5>
          <p class="mb-1"><span class="fw-semibold">Concelho:</span> <%= c.municipality || '—' %></p>
          <p class="mb-1"><span class="fw-semibold">Morada:</span> <%= c.address || '—' %></p>
          <p class="mb-1"><span class="fw-semibold">Código postal:</span> <%= c.postcode || '—' %></p>
          <p class="mb-1"><span class="fw-semibold">Telefone:</span> <%= c.phone || '—' %></p>
          <p class="mb-1"><span class="fw-semibold">NIF:</span> <%= c.nif || '—' %></p>
          <p class="mb-1"><span class="fw-semibold">E-mail:</span> <%= c.mail || '—' %></p>
        </div>
      </div>

      <% if (c.about_us) { %>
        <hr />
        <p class="mb-0"><%= c.about_us %></p>
      <% } %>
    </div>
  </div>

  <% } %>

  <div class="d-grid gap-2 mt-3">
    <a
      href="/submit-application?id=<%= announcement._id %>"
      class="d-grid gap-2 text-reset text-decoration-none"
    >
      <button class="btn btn-blue">Enviar Candidatura</button>
    </a>
    <button class="btn btn-black" onclick="history.back()">Voltar</button>
  </div>
</div>

<script src="/js/home-details-announcement.js"></script>