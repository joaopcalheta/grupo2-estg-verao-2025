<head>
  <link href="/css/ad.css" rel="stylesheet" />
  <link href="/css/general.css" rel="stylesheet" />
</head>

<h2>Gerir An√∫ncio</h2>
  <form id="editAnuncioForm">
    <label>Nome da profiss√£o
      <input type="text" name="title" id="title">
    </label>
    <label>Categoria
      <select name="category" id="category">
        <option>-- Selecione uma op√ß√£o --</option>
        <option>Restaura√ß√£o</option>
        <option>Limpeza</option>
        <option>Constru√ß√£o</option>
        <option>Vendedor</option>
      </select>
    </label>
    <label>Tipo de contrato
      <select name="type" id="type">
        <option>-- Selecione uma op√ß√£o --</option>
        <option>Emprego</option>
        <option>Est√°gio</option>
      </select>
    </label>
    <label>Local do emprego
      <input type="text" name="location" id="location">
    </label>
    <label>Regime
      <select name="regime" id="regime">
        <option>-- Selecione uma op√ß√£o --</option>
        <option>Full-Time</option>
        <option>Part-Time</option>
      </select>
    </label>
    <label>Descri√ß√£o
      <textarea name="description" id="description"></textarea>
    </label>
    <label>Foto Atual
      <img src="" id="currentPhoto">
    </label>
    <label>Atualizar Foto
      <input type="file" name="photo">
    </label>
    <div class="actions-btn">
      <button type="button" class="btn btn-blue" onclick="history.back()">Voltar</button>
      <button type="submit" class="btn btn-blue">Guardar</button>
    </div>
    <div class="actions-btn">
      <button class="btn btn-delete">Eliminar üóëÔ∏è</button>
    </div>
  </form>

  <script>
 
  document.addEventListener("DOMContentLoaded", function () {
    const anuncios = JSON.parse(localStorage.getItem('anuncios')) || [];
    const index = localStorage.getItem('editIndex');
    const anuncio = anuncios[index];


    // BUSCA OS DADOS INTRODUZIDOS QUANDO FOI CRIADO O ANUNCIO
    document.getElementById('title').value = anuncio.profissao || '';
    document.getElementById('category').value = anuncio.categoria || '';
    document.getElementById('type').value = anuncio.tipo || '';
    document.getElementById('location').value = anuncio.local || '';
    document.getElementById('regime').value = anuncio.regime || '';
    document.getElementById('description').value = anuncio.descricao || '';
    document.getElementById('currentPhoto').src = anuncio.foto || 'images/anuncio1.jpg';
  });


  // GUARDA AS ALTERA√áOES DO ANUNCIO CASO TENHA SIDO EDITADO
  document.getElementById('editAnuncioForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const anuncios = JSON.parse(localStorage.getItem('anuncios')) || [];
    const index = localStorage.getItem('editIndex');

    const form = e.target;
    const updatedAnuncio = {
      profissao: form.title.value,
      categoria: form.category.value,
      tipo: form.type.value,
      local: form.location.value,
      regime: form.regime.value,
      descricao: form.description.value,
      foto: anuncios[index].foto
    };

    anuncios[index] = updatedAnuncio;
    localStorage.setItem('anuncios', JSON.stringify(anuncios));
    alert("An√∫ncio atualizado com sucesso.");
    window.location.href = "/myAds";
  });

</script>