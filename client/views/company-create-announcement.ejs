<head>
  <link href="/css/general.css" rel="stylesheet" />
  <link href="/css/form.css" rel="stylesheet" />
</head>

<div class="container-ad">
  <h2 class="text-center my-4">Criar Anúncio</h2>
  <form method="POST" action="/company-create-announcement/<%= companyID %>" enctype="multipart/form-data">
    <label>
      Nome da profissão
      <input
        type="text"
        name="job_name"
        required
        minlength="3"
        maxlength="100"
      />
    </label>

    <label>
      Categoria
      <select name="category" required>
        <option disabled selected>Selecione uma categoria</option>
        <option value="Restauração">Restauração</option>
        <option value="Limpeza">Limpeza</option>
        <option value="Construção">Construção</option>
        <option value="Vendedor">Vendedor</option>
        <option value="Saúde">Saúde</option>
        <option value="Educação">Educação</option>
        <option value="IT">IT</option>
        <option value="Administração">Administração</option>
        <option value="Transporte">Transporte</option>
        <option value="Atendimento ao Cliente">Atendimento ao Cliente</option>
        <option value="Marketing">Marketing</option>
        <option value="Financeiro">Financeiro</option>
        <option value="Logística">Logística</option>
        <option value="Segurança">Segurança</option>
        <option value="Serviços Gerais">Serviços Gerais</option>
      </select>
    </label>

    <label>
      Tipo de contrato
      <select name="type" required>
        <option disabled selected>Selecione uma opção</option>
        <option value="Emprego">Emprego</option>
        <option value="Estágio">Estágio</option>
      </select>
    </label>

    <label>
      Concelho
      <select name="municipality" id="municipality" required>
        <option disabled selected>Selecione um concelho</option>
        <option value="Ponta do Sol">Ponta do Sol</option>
        <option value="Calheta">Calheta</option>
        <option value="Ribeira Brava">Ribeira Brava</option>
        <option value="Câmara de Lobos">Câmara de Lobos</option>
        <option value="Funchal">Funchal</option>
        <option value="Santa Cruz">Santa Cruz</option>
        <option value="Machico">Machico</option>
        <option value="Santana">Santana</option>
        <option value="São Vicente">São Vicente</option>
        <option value="Porto Moniz">Porto Moniz</option>
        <option value="Porto Santo">Porto Santo</option>
      </select>
    </label>

    <label>
      Freguesia
      <select name="freg" id="freguesia" disabled required>
        <option selected>Selecione um concelho primeiro</option>
      </select>
    </label>

    <label>
      Morada
      <input type="text" name="address" required />
    </label>

    <label>
      Código postal
      <input
        type="text"
        name="postcode"
        required
        pattern="[0-9]{4}-[0-9]{3}"
        title="Formato: 1234-567"
      />
    </label>

    <label>
      Regime
      <select name="regime" required>
        <option disabled selected>Selecione uma opção</option>
        <option value="Full-Time">Full-Time</option>
        <option value="Part-Time">Part-Time</option>
      </select>
    </label>

    <label>
      Escolaridade
      <select name="education_level" required>
        <option disabled selected>Selecione uma opção</option>
        <option value="ensino básico">Ensino Básico</option>
        <option value="ensino secundário">Ensino Secundário</option>
        <option value="ensino superior">Ensino Superior</option>
      </select>
    </label>

    <div class="mb-3">
      <p class="mb-3 fw-bold">Línguas</p>
      <div class="d-flex flex-wrap gap-3">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="languages[]"
            value="Eng"
            id="lingua-ingles"
          />
          <label class="form-check-label h6" for="lingua-ingles">Inglês</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="languages[]"
            value="Fr"
            id="lingua-frances"
          />
          <label class="form-check-label h6" for="lingua-frances"
            >Francês</label
          >
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="languages[]"
            value="Esp"
            id="lingua-espanhol"
          />
          <label class="form-check-label h6" for="lingua-espanhol"
            >Espanhol</label
          >
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="languages[]"
            value="Ger"
            id="lingua-alemao"
          />
          <label class="form-check-label h6" for="lingua-alemao">Alemão</label>
        </div>
      </div>
    </div>

    <label>
      Salário
      <input type="number" name="salary" min="0" step="0.01" />
    </label>

    <label>Horário de trabalho</label>
    <div class="d-inline-flex p-2 gap-5">
      <div class="form-group">
        <label for="inicio">Início</label>
        <input type="time" id="inicio" name="schedule[startTime]" />
      </div>

      <div class="form-group">
        <label for="fim">Fim</label>
        <input type="time" id="fim" name="schedule[endTime]" />
      </div>
    </div>

    <label>
      Prazo de candidatura
      <input type="date" name="end_date" id="end_date" required />
    </label>

    <label>
      Número de vagas
      <input
        type="number"
        name="numberOfPositions"
        value="1"
        min="1"
        required
      />
    </label>

    <label>
      Descrição
      <textarea name="description" rows="4" required minlength="10"></textarea>
    </label>

    <div>
      <p class="fw-bold">Adicionar Foto</p>
      <label>
        <input type="file" name="pic" accept="image/*"/>
      </label>
      <!--<input type="file" name="pic" class="d-none" id="fileInput" />
      <label for="fileInput" class="btn btn-primary">
        <i class="bi bi-upload"></i> Enviar
      </label>-->
    </div>

    <% if (typeof announcement !== "undefined" && announcement.pic) { %>
    <img
      src="<%= announcement.pic %>"
      alt="Imagem do anúncio"
      class="<%= announcement.pic === '/img/default.jpg' ? 'classe-default' : 'classe-custom' %>"
    />
    <% } %>

    <div class="actions-btn">
      <button type="button" class="btn btn-black" onclick="history.back()">
        Voltar
      </button>
      <button type="submit" class="btn btn-blue">Criar</button>
    </div>
  </form>
</div>

<script src="/js/company-create-announcement.js"></script>

<!-- Validação extra para data de término (precisa ser futura) -->
<script>
  document.querySelector("form").addEventListener("submit", function (e) {
    const endDateInput = document.getElementById("end_date");
    const endDate = new Date(endDateInput.value);
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    if (endDate <= today) {
      e.preventDefault();
      alert("A data de término deve ser futura.");
      endDateInput.focus();
    }
  });
</script>
