<!-- search-filter.ejs -->
<head>
  <link href="/css/search-filter.css" rel="stylesheet" />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
</head>

<!-- tirar dps -->
<head>
  <link href="/css/home.css" rel="stylesheet" />
</head>

<!-- tirar dps  -->
<div class="white-card p-3">
  <form action="/" method="GET">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="p-0 m-0 fw-bold">FILTRAR</h1>
      <button
        onclick="window.location.href='/search-filter?<%= new URLSearchParams(query).toString() %>'"
        type="submit"
        class="btn-close close-btn pt-1 p-0"
      ></button>
    </div>

    <!-- Categoria -->
    <div class="pe-3">
      <div class="pe-3">
        <button
          class="text-start white-card p-1 px-3 filter-option d-flex justify-content-between align-items-center"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#filtro-categoria"
          aria-expanded="true"
          aria-controls="filtro-categoria"
          id="btn-categoria"
        >
          Categoria
          <i class="bi bi-chevron-down rotate-icon"></i>
        </button>
      </div>

      <div class="collapse show ps-3" id="filtro-categoria">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="categoria1"
            name="category"
            value="educacao"
          />
          <label class="form-check-label" for="categoria1">Educação</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="categoria2"
            name="category"
            value="saude"
          />
          <label class="form-check-label" for="categoria2">Saúde</label>
        </div>
      </div>
    </div>

    <!-- Tipo -->
    <div class="pe-3">
      <div class="pe-3">
        <button
          class="text-start white-card p-1 px-3 filter-option d-flex justify-content-between align-items-center"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#filtro-tipo"
          aria-expanded="true"
          aria-controls="filtro-tipo"
          id="btn-tipo"
        >
          Tipo
          <i class="bi bi-chevron-down rotate-icon"></i>
        </button>
      </div>

      <div class="collapse show ps-3" id="filtro-tipo">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="type"
            id="tipo1"
            value="emp"
          />
          <label class="form-check-label" for="tipo1">Emprego</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="type"
            id="tipo2"
            value="est"
          />
          <label class="form-check-label" for="tipo2">Estágio</label>
        </div>
      </div>
    </div>

    <!-- Regime -->
    <div class="pe-3">
      <div class="pe-3">
        <button
          class="text-start white-card p-1 px-3 filter-option d-flex justify-content-between align-items-center"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#filtro-regime"
          aria-expanded="true"
          aria-controls="filtro-regime"
          id="btn-regime"
        >
          Regime
          <i class="bi bi-chevron-down rotate-icon"></i>
        </button>
      </div>

      <div class="collapse show ps-3" id="filtro-regime">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="regime"
            id="regime1"
            value="ftime"
          />
          <label class="form-check-label" for="regime1">Full-time</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            name="regime"
            id="regime2"
            value="ptime"
          />
          <label class="form-check-label" for="regime2">Part-time</label>
        </div>
      </div>
    </div>

    <!-- Concelho -->
    <div class="pe-3">
      <div class="pe-3">
        <button
          class="text-start white-card p-1 px-3 filter-option d-flex justify-content-between align-items-center"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#filtro-concelho"
          aria-expanded="true"
          aria-controls="filtro-concelho"
          id="btn-concelho"
        >
          Concelho
          <i class="bi bi-chevron-down rotate-icon"></i>
        </button>
      </div>

      <div class="collapse show ps-3" id="filtro-concelho">
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="pds"
            value="pds"
          /><label class="form-check-label" for="pds">Ponta do Sol</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="clt"
            value="clt"
          /><label class="form-check-label" for="calheta">Calheta</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="rb"
            value="rb"
          /><label class="form-check-label" for="rb">Ribeira Brava</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="cl"
            value="cl"
          /><label class="form-check-label" for="cl">Câmara de Lobos</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="fc"
            value="fc"
          /><label class="form-check-label" for="funchal">Funchal</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="sc"
            value="sc"
          /><label class="form-check-label" for="sc">Santa Cruz</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="mc"
            value="mc"
          /><label class="form-check-label" for="machico">Machico</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="st"
            value="st"
          /><label class="form-check-label" for="santana">Santana</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="sv"
            value="sv"
          /><label class="form-check-label" for="sv">São Vicente</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="pm"
            value="pm"
          /><label class="form-check-label" for="pm">Porto Moniz</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="municipality"
            type="checkbox"
            id="ps"
            value="ps"
          /><label class="form-check-label" for="ps">Porto Santo</label>
        </div>
      </div>
    </div>

    <!-- Escolaridade -->
    <div class="pe-3">
      <div class="pe-3">
        <button
          class="text-start white-card p-1 px-3 filter-option d-flex justify-content-between align-items-center"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#filtro-escolaridade"
          aria-expanded="true"
          aria-controls="filtro-escolaridade"
          id="btn-escolaridade"
        >
          Escolaridade
          <i class="bi bi-chevron-down rotate-icon"></i>
        </button>
      </div>

      <div class="collapse show ps-3" id="filtro-escolaridade">
        <div class="form-check">
          <input
            class="form-check-input"
            name="education_level"
            type="checkbox"
            id="1c"
            value="1c"
          /><label class="form-check-label" for="1c">1º ciclo</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="education_level"
            type="checkbox"
            id="2c"
            value="2c"
          /><label class="form-check-label" for="2c">2º ciclo</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="education_level"
            type="checkbox"
            id="3c"
            value="3c"
          /><label class="form-check-label" for="3c">3º ciclo</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="education_level"
            type="checkbox"
            id="sec"
            value="sec"
          /><label class="form-check-label" for="sec">Secundário</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            name="education_level"
            type="checkbox"
            id="es"
            value="es"
          /><label class="form-check-label" for="es">Ensino Superior</label>
        </div>
      </div>
    </div>
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const buttons = document.querySelectorAll(".filter-option");

      buttons.forEach((button) => {
        const targetId = button
          .getAttribute("data-bs-target")
          ?.replace("#", "");
        const target = document.getElementById(targetId);
        const icon = button.querySelector(".rotate-icon");

        if (!target || !icon) return;

        target.addEventListener("show.bs.collapse", () => {
          icon.classList.add("rotated");
          button.classList.add("active-bold");
        });

        target.addEventListener("hide.bs.collapse", () => {
          icon.classList.remove("rotated");
          button.classList.remove("active-bold");
        });

        // Set initial state
        if (target.classList.contains("show")) {
          icon.classList.add("rotated");
          button.classList.add("active-bold");
        }
      });
    });
  </script>
</div>
